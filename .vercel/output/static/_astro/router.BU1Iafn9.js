const E="data-astro-transition-persist",L=new Set;function R(e){const n=e.src?new URL(e.src,location.href).href:e.textContent;return!!L.has(n)||(L.add(n),!1)}const x=({activeElement:e,start:n,end:t})=>{e&&(e.focus(),(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)&&(typeof n=="number"&&(e.selectionStart=n),typeof t=="number"&&(e.selectionEnd=t)))},B=(e,n)=>{const t=e.getAttribute(E),r=t&&n.head.querySelector(`[${E}="${t}"]`);if(r)return r;if(e.matches("link[rel=stylesheet]")){const i=e.getAttribute("href");return n.head.querySelector(`link[rel=stylesheet][href="${i}"]`)}return null},V=e=>{const n=e.dataset.astroTransitionPersistProps;return n==null||n==="false"},K=(e,n)=>e.getAttribute("props")===n.getAttribute("props"),z=e=>{(function(t){for(const r of t.scripts)!r.hasAttribute("data-astro-rerun")&&R(r)&&(r.dataset.astroExec="")})(e),function(t){const r=document.documentElement,i=[...r.attributes].filter(({name:s})=>(r.removeAttribute(s),s.startsWith("data-astro-")));[...t.documentElement.attributes,...i].forEach(({name:s,value:c})=>r.setAttribute(s,c))}(e),function(t){for(const r of Array.from(document.head.children)){const i=B(r,t);i?i.remove():r.remove()}document.head.append(...t.head.children)}(e);const n=(()=>{const t=document.activeElement;if(t?.closest(`[${E}]`)){if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement){const r=t.selectionStart,i=t.selectionEnd;return()=>x({activeElement:t,start:r,end:i})}return()=>x({activeElement:t})}return()=>x({activeElement:null})})();(function(t,r){r.replaceWith(t);for(const i of r.querySelectorAll(`[${E}]`)){const s=i.getAttribute(E),c=t.querySelector(`[${E}="${s}"]`);c&&(c.replaceWith(i),c.localName==="astro-island"&&V(i)&&!K(i,c)&&(i.setAttribute("ssr",""),i.setAttribute("props",c.getAttribute("props"))))}})(e.body,document.body),n()},G="astro:after-preparation",J="astro:before-swap";class C extends Event{from;to;direction;navigationType;sourceElement;info;newDocument;signal;constructor(n,t,r,i,s,c,u,a,o,l){super(n,t),this.from=r,this.to=i,this.direction=s,this.navigationType=c,this.sourceElement=u,this.info=a,this.newDocument=o,this.signal=l,Object.defineProperties(this,{from:{enumerable:!0},to:{enumerable:!0,writable:!0},direction:{enumerable:!0,writable:!0},navigationType:{enumerable:!0},sourceElement:{enumerable:!0},info:{enumerable:!0},newDocument:{enumerable:!0,writable:!0},signal:{enumerable:!0}})}}class Q extends C{formData;loader;constructor(n,t,r,i,s,c,u,a,o,l){super("astro:before-preparation",{cancelable:!0},n,t,r,i,s,c,u,a),this.formData=o,this.loader=l.bind(this,this),Object.defineProperties(this,{formData:{enumerable:!0},loader:{enumerable:!0,writable:!0}})}}class Z extends C{direction;viewTransition;swap;constructor(n,t){super(J,void 0,n.from,n.to,n.direction,n.navigationType,n.sourceElement,n.info,n.newDocument,n.signal),this.direction=n.direction,this.viewTransition=t,this.swap=()=>z(this.newDocument),Object.defineProperties(this,{direction:{enumerable:!0},viewTransition:{enumerable:!0},swap:{enumerable:!0,writable:!0}})}}async function _(e,n,t,r,i,s,c,u,a){const o=new Q(e,n,t,r,i,s,window.document,c,u,a);var l;return document.dispatchEvent(o)&&(await o.loader(),o.defaultPrevented||(l=G,document.dispatchEvent(new Event(l)),o.navigationType!=="traverse"&&D({scrollX,scrollY}))),o}const ee=history.pushState.bind(history),T=history.replaceState.bind(history),D=e=>{history.state&&(history.scrollRestoration="manual",T({...history.state,...e},""))},H=!!document.startViewTransition,k=()=>!!document.querySelector('[name="astro-view-transitions-enabled"]'),$=(e,n)=>e.pathname===n.pathname&&e.search===n.search;let h,b,A;const I=e=>document.dispatchEvent(new Event(e)),j=()=>I("astro:page-load"),P="data-astro-transition-persist",X="data-astro-transition",S="data-astro-transition-fallback";let Y,g=0;function F(){const e=document.querySelector('[name="astro-view-transitions-fallback"]');return e?e.getAttribute("content"):"animate"}history.state?(g=history.state.index,scrollTo({left:history.state.scrollX,top:history.state.scrollY})):k()&&(T({index:g,scrollX,scrollY},""),history.scrollRestoration="manual");const N=(e,n,t,r,i)=>{const s=$(n,e),c=document.title;document.title=r;let u=!1;if(e.href!==location.href&&!i)if(t.history==="replace"){const a=history.state;T({...t.state,index:a.index,scrollX:a.scrollX,scrollY:a.scrollY},"",e.href)}else ee({...t.state,index:++g,scrollX:0,scrollY:0},"",e.href);if(document.title=c,A=e,s||(scrollTo({left:0,top:0,behavior:"instant"}),u=!0),i)scrollTo(i.scrollX,i.scrollY);else{if(e.hash){history.scrollRestoration="auto";const a=history.state;location.href=e.href,history.state||(T(a,""),s&&window.dispatchEvent(new PopStateEvent("popstate")))}else u||scrollTo({left:0,top:0,behavior:"instant"});history.scrollRestoration="manual"}};async function q(e,n,t,r,i){async function s(a){const o=document.getAnimations();document.documentElement.setAttribute(S,a);const l=document.getAnimations().filter(d=>!o.includes(d)&&!function(p){const m=p.effect;return!!(m&&m instanceof KeyframeEffect&&m.target)&&window.getComputedStyle(m.target,m.pseudoElement).animationIterationCount==="infinite"}(d));return Promise.allSettled(l.map(d=>d.finished))}if(i==="animate"&&!t.transitionSkipped&&!e.signal.aborted)try{await s("old")}catch{}const c=document.title,u=function(a,o){const l=new Z(a,o);return document.dispatchEvent(l),l.swap(),l}(e,t.viewTransition);N(u.to,u.from,n,c,r),I("astro:after-swap"),i==="animate"&&(t.transitionSkipped||u.signal.aborted?t.viewTransitionFinished():s("new").finally(()=>t.viewTransitionFinished()))}async function U(e,n,t,r,i){const s=(h?.controller.abort(),h={controller:new AbortController});if(!k()||location.origin!==t.origin)return s===h&&(h=void 0),void(location.href=t.href);const c=i?"traverse":r.history==="replace"?"replace":"push";if(c!=="traverse"&&D({scrollX,scrollY}),$(n,t)&&(e!=="back"&&t.hash||e==="back"&&n.hash))return N(t,n,r,document.title,i),void(s===h&&(h=void 0));const u=await _(n,t,e,c,r.sourceElement,r.info,s.controller.signal,r.formData,async function(o){const l=o.to.href,d={signal:o.signal};if(o.formData){d.method="POST";const f=o.sourceElement instanceof HTMLFormElement?o.sourceElement:o.sourceElement instanceof HTMLElement&&"form"in o.sourceElement?o.sourceElement.form:o.sourceElement?.closest("form");d.body=n!==void 0&&Reflect.get(HTMLFormElement.prototype,"attributes",f).getNamedItem("enctype")?.value==="application/x-www-form-urlencoded"?new URLSearchParams(o.formData):o.formData}const p=await async function(f,y){try{const v=await fetch(f,y),w=(v.headers.get("content-type")??"").split(";",1)[0].trim();return w!=="text/html"&&w!=="application/xhtml+xml"?null:{html:await v.text(),redirected:v.redirected?v.url:void 0,mediaType:w}}catch{return null}}(l,d);if(p===null)return void o.preventDefault();if(p.redirected){const f=new URL(p.redirected);if(f.origin!==o.to.origin)return void o.preventDefault();o.to=f}if(Y??=new DOMParser,o.newDocument=Y.parseFromString(p.html,p.mediaType),o.newDocument.querySelectorAll("noscript").forEach(f=>f.remove()),!o.newDocument.querySelector('[name="astro-view-transitions-enabled"]')&&!o.formData)return void o.preventDefault();const m=function(f){const y=[];for(const v of f.querySelectorAll("head link[rel=stylesheet]"))if(!document.querySelector(`[${P}="${v.getAttribute(P)}"], link[rel=stylesheet][href="${v.getAttribute("href")}"]`)){const w=document.createElement("link");w.setAttribute("rel","preload"),w.setAttribute("as","style"),w.setAttribute("href",v.getAttribute("href")),y.push(new Promise(O=>{["load","error"].forEach(W=>w.addEventListener(W,O)),document.head.append(w)}))}return y}(o.newDocument);m.length&&!o.signal.aborted&&await Promise.all(m)});if(u.defaultPrevented||u.signal.aborted)return s===h&&(h=void 0),void(u.signal.aborted||(location.href=t.href));const a=await async function(){if(b&&b.viewTransition){try{b.viewTransition.skipTransition()}catch{}try{await b.viewTransition.updateCallbackDone}catch{}}return b={transitionSkipped:!1}}();if(u.signal.aborted)s===h&&(h=void 0);else{if(document.documentElement.setAttribute(X,u.direction),H)a.viewTransition=document.startViewTransition(async()=>await q(u,r,a,i));else{const o=(async()=>{await Promise.resolve(),await q(u,r,a,i,F())})();a.viewTransition={updateCallbackDone:o,ready:o,finished:new Promise(l=>a.viewTransitionFinished=l),skipTransition:()=>{a.transitionSkipped=!0,document.documentElement.removeAttribute(S)},types:new Set}}a.viewTransition?.updateCallbackDone.finally(async()=>{await function(){let o=Promise.resolve(),l=!1;for(const d of document.getElementsByTagName("script"))d.dataset.astroExec===void 0&&d.getAttribute("type")==="module"&&(l=d.getAttribute("src")===null);l&&document.body.insertAdjacentHTML("beforeend",'<script type="module" src="data:application/javascript,"/>');for(const d of document.getElementsByTagName("script")){if(d.dataset.astroExec==="")continue;const p=d.getAttribute("type");if(p&&p!=="module"&&p!=="text/javascript")continue;const m=document.createElement("script");m.innerHTML=d.innerHTML;for(const f of d.attributes){if(f.name==="src"){const y=new Promise(v=>{m.onload=m.onerror=v});o=o.then(()=>y)}m.setAttribute(f.name,f.value)}m.dataset.astroExec="",d.replaceWith(m)}return o}(),j(),(()=>{let o=document.createElement("div");o.setAttribute("aria-live","assertive"),o.setAttribute("aria-atomic","true"),o.className="astro-route-announcer",document.body.append(o),setTimeout(()=>{let l=document.title||document.querySelector("h1")?.textContent||location.pathname;o.textContent=l},60)})()}),a.viewTransition?.finished.finally(()=>{a.viewTransition=void 0,a===b&&(b=void 0),s===h&&(h=void 0),document.documentElement.removeAttribute(X),document.documentElement.removeAttribute(S)});try{await a.viewTransition?.updateCallbackDone}catch(o){const l=o;console.log("[astro]",l.name,l.message,l.stack)}}}async function te(e,n){await U("forward",A,new URL(e,location.href),n??{})}const M=()=>{!history.state||scrollX===history.state.scrollX&&scrollY===history.state.scrollY||D({scrollX,scrollY})};if(H||F()!=="none")if(A=new URL(location.href),addEventListener("popstate",function(e){if(!k()&&e.state)return void location.reload();if(e.state===null)return;const n=history.state,t=n.index,r=t>g?"forward":"back";g=t,U(r,A,new URL(location.href),{},n)}),addEventListener("load",j),"onscrollend"in window)addEventListener("scrollend",M);else{let e,n,t,r;const i=()=>r!==history.state?.index?(clearInterval(e),void(e=void 0)):n===scrollY&&t===scrollX?(clearInterval(e),e=void 0,void M()):(n=scrollY,void(t=scrollX));addEventListener("scroll",()=>{e===void 0&&(r=history.state?.index,n=scrollY,t=scrollX,e=window.setInterval(i,50))},{passive:!0})}for(const e of document.getElementsByTagName("script"))R(e),e.dataset.astroExec="";export{G as T,J as a,te as n,H as s};
